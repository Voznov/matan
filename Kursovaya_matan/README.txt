Итак, делал я на gnu c++ какой-то старой версии, т.е. новые версии должны зайти. 
Правда, может быть косяк с тем, что он некоторые строчки в ответе будет обрезать.
Если это случится (хотя маловероятно) - напиши мне (vk.com/voznov_peter), исправлю.
Прога распознаёт + - * / ** ln() sin() cos() tan() cot() asin() acos() atan() acot()
А также считает за константу e pi
Не сокращает формулу!

Компилятор mingw32-g++ 
В проекте валяется exe в \bin\Debug
А также deriv.in в корне - там функции, которые я тестил на валидность
Компилим main.cpp (он в корне) любой gnu c++
Прога имеет #include <bits/stdc++.h> 
И да, разбираться в коде можно, но там столько #define, что на разборки уйдёт немалое время
Удачи)